{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport axios from 'axios';\nexport default {\n  name: 'forgetPwd',\n  data: function data() {\n    return {\n      show_1: true,\n      show_2: false,\n      show_3: false,\n      show_4: false,\n      imageUrl: '/static/images/VerifyCode.jpg',\n      fogetArgs: \"\",\n      imageVarifyCode: \"\",\n      userId: null,\n      phone: null,\n      userEmail: null,\n      userName: null,\n      password: null,\n      code: null,\n      text: \"\",\n      smsCode: null,\n      smsCodeInput: \"\",\n      isSuccess: false\n    };\n  },\n  methods: {\n    handleChange: function handleChange(isSuccess) {\n      console.log(isSuccess);\n    },\n    onSuccess: function onSuccess() {\n      console.log(\"验证成功\");\n      this.isSuccess = true;\n    },\n    onFail: function onFail() {\n      console.log(\"验证失败\");\n      this.isSuccess = false;\n    },\n    onRefresh: function onRefresh() {\n      console.log(\"验证码刷新\");\n    },\n    getSMSCode: function getSMSCode() {\n      //获取验证码\n      var that = this;\n      axios({\n        method: 'post',\n        url: '/api/user/sendVerifyCode',\n        data: {\n          userId: that.userId,\n          phone: that.phone,\n          userEmail: that.userEmail,\n          userName: that.userName,\n          password: that.password,\n          code: that.code\n        }\n      }).then(function (result) {\n        console.log(result.data);\n        that.smsCode = result.data;\n      });\n    },\n    getUserInfo: function getUserInfo() {\n      //获取用户详细信息\n      var that = this;\n      axios({\n        method: 'post',\n        url: '/api/user-info/getUserInfo',\n        data: {\n          userId: that.userId,\n          phone: that.phone,\n          userEmail: that.userEmail,\n          userName: that.userName,\n          password: that.password,\n          code: that.code\n        }\n      }).then(function (result) {\n        console.log(result);\n        // console.log(result.data.object.phone)\n        that.phone = result.data.object.phone;\n        console.log(result.data.object.userName);\n        that.userName = result.data.object.userName;\n      });\n    },\n    validateCode: function validateCode() {\n      var that = this;\n      return new Promise(function (resolve, reject) {\n        axios({\n          method: 'post',\n          url: '/api/user/validateCode',\n          data: {\n            userId: that.userId,\n            phone: that.phone,\n            userEmail: that.userEmail,\n            userName: that.userName,\n            password: that.password,\n            code: that.smsCodeInput\n          }\n        }).then(function (result) {\n          console.log(\"验证码校验的返回值：\" + result.data.code);\n          if (result.data.code == \"100001\") {\n            resolve(true);\n          } else {\n            resolve(false);\n          }\n        });\n      });\n    },\n    show: function show(stepIndex) {\n      switch (stepIndex) {\n        case 1:\n          if (this.fogetArgs == \"\") {\n            alert(\"请输入完整信息！\");\n            return;\n          }\n          if (!this.isSuccess) {\n            alert(\"请进行人机校验\");\n            return;\n          }\n          var phoneRegex = /^[1-9]\\d{10}$/;\n          var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;\n          var usernameRegex = /^user_\\d+$/;\n\n          //发送请求获取图片验证码 todo\n          // axios({\n          //     method: 'get', \n          //     url: '/api/user-info/getImageVerifyCode',\n          // })\n          // .then(function(result){\n\n          // })\n\n          if (phoneRegex.test(this.fogetArgs)) {\n            this.phone = this.fogetArgs;\n            this.text = \"激活码已经发送到您的手机：\" + this.phone + \" 中\";\n          }\n          if (emailRegex.test(this.fogetArgs)) {\n            this.userEmail = this.fogetArgs;\n            this.text = \"激活码已经发送到您的邮箱：\" + this.userEmail + \" 中\";\n          }\n          if (usernameRegex.test(this.fogetArgs)) {\n            this.userName = this.fogetArgs;\n            var _that = this;\n            //获取用户详细信息\n            this.getUserInfo();\n            _that.text = \"激活码已经发送到您的手机：\" + _that.phone + \" 中\";\n          }\n          this.show_1 = false;\n          this.show_2 = true;\n          break;\n        //cookie中存放用户编号和用户名\n        case 2:\n          // let r = this.validateCode();\n          // if (!r) {\n          //     break\n          // }\n          var that = this;\n          this.validateCode().then(function (result) {\n            if (result) {\n              that.getUserInfo();\n              that.show_2 = false;\n              that.show_3 = true;\n            } else {\n              alert(\"验证码校验不通过\");\n              return;\n            }\n          });\n          break;\n        case 3:\n          this.show_3 = false;\n          this.show_4 = true;\n          break;\n        case 4:\n          break;\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","show_1","show_2","show_3","show_4","imageUrl","fogetArgs","imageVarifyCode","userId","phone","userEmail","userName","password","code","text","smsCode","smsCodeInput","isSuccess","methods","handleChange","console","log","onSuccess","onFail","onRefresh","getSMSCode","that","method","url","then","result","getUserInfo","object","validateCode","Promise","resolve","reject","show","stepIndex","alert","phoneRegex","emailRegex","usernameRegex","test"],"sources":["src/pages/page-login/components/ForgetPwdView.vue"],"sourcesContent":["<template>\n    <div>\n        <div class=\"header\">\n            <div class=\"mainwarp\">\n                <div class=\"logo\"><a href=\"/index\"><img src=\"/static/images/log.png\" /></a></div>\n                <div class=\"welcome\">重置密码</div>\n                <div class=\"headerright\">\n                    <a href=\"/login\">个人登录 </a>\n                    <span>|</span>\n                    <a href=\"/index\">返回首页</a>\n                </div>\n            </div>\n        </div>\n        <div class=\"passdBox\">\n            <div class=\"passpart1\">\n                <div class=\"TitleNotice\">忘记密码了？根据收到的激活码进行验证身份，通过验证后重置密码，您就可以登录了。</div>\n                <div class=\"StepsBox\">\n                    <div id=\"step_div_1\" class=\"Step stepfirst\" :class=\"{ Active: show_1 }\">\n                        <span class=\"StepNo\">1</span>\n                        <span class=\"StepName\">确认账户</span>\n                    </div>\n                    <div id=\"step_div_2\" class=\"Step\" :class=\"{ Active: show_2 }\">\n                        <span class=\"StepNo\">2</span>\n                        <span class=\"StepName\">安全认证</span>\n                    </div>\n                    <div id=\"step_div_3\" class=\"Step\" :class=\"{ Active: show_3 }\">\n                        <span class=\"StepNo\">3</span>\n                        <span class=\"StepName\">重置密码</span>\n                    </div>\n                    <div id=\"step_div_4\" class=\"Step steplast\" :class=\"{ Active: show_4 }\">\n                        <span class=\"StepNo\"></span>\n                        <span class=\"StepName\">完成</span>\n                    </div>\n                </div>\n                <div class=\"clear\"></div>\n                <div id=\"step_1\" class=\"restInfo\" v-show=\"show_1\">\n                    <div class=\"box1\">\n                        <span>账 户：</span>\n                        <input name=\"\" v-model=\"fogetArgs\" type=\"text\" placeholder=\"用户名/邮箱/已验证手机号\" />\n                        <div class=\"clear\"></div>\n                    </div>\n                    <div class=\"box1\">\n                        <!-- <span>验证码：</span>\n                        <input name=\"\" v-model=\"imageVarifyCode\" type=\"text\" class=\"yzm\" />\n                        <img :src=\"imageUrl\" width=\"100\" height=\"35\" />\n                        <div class=\"clear\"></div> -->\n                        <span>人机校验：</span>\n                        <SliderVerificationCode height=\"42px\" sliderWidth=\"50px\" inactiveValue = false activeValue = true\n                            v-model=\"isSuccess\" />\n\n                    </div>\n                    <div class=\"box1\">\n                        <input type=\"button\" class=\"onebtn\" @click=\"show(1)\" value=\"下一步\" />\n                    </div>\n                </div>\n                <div id=\"step_2\" class=\"restInfo\" v-show=\"show_2\">\n                    <div class=\"box2\"> {{ text }} </div>\n\n                    <div class=\"box1\">\n                        <span>激活码：</span>\n                        <input name=\"smsCodeInput\" v-model=\"smsCodeInput\" type=\"text\" class=\"yzm\" />\n                        <b class=\"phonenum\" @click=\"getSMSCode()\">获取短信验证码</b>\n                        <div class=\"clear\"></div>\n                    </div>\n                    <div class=\"box1\">\n                        <input type=\"button\" class=\"onebtn\" @click=\"show(2)\" value=\"下一步\" />\n                    </div>\n                </div>\n                <div id=\"step_3\" class=\"restInfo\" v-show=\"show_3\">\n                    <div class=\"box2\">\n                        <span class=\"span1\">用户名：</span>\n                        <span class=\"span2\">{{ userName }}</span>\n                        <div class=\"clear\"></div>\n                    </div>\n                    <div class=\"box1\">\n                        <span>新密码：</span>\n                        <input name=\"\" type=\"text\" />\n                        <div class=\"clear\"></div>\n                    </div>\n                    <div class=\"box1\">\n                        <span>确认密码：</span>\n                        <input name=\"\" type=\"text\" />\n                        <div class=\"clear\"></div>\n                    </div>\n                    <div class=\"box1\">\n                        <input type=\"button\" class=\"onebtn\" @click=\"show(3)\" value=\"下一步\" />\n                    </div>\n                </div>\n                <div id=\"step_4\" class=\"restInfo2\" v-show=\"show_4\">\n                    <div class=\"SucTitle\">恭喜您，您的密码设置成功！</div>\n                    <p>您的用户名是：HEB5_14@your_email.com</p>\n                    <p>您可以使用新密码登录蝶飞人才网<a href=\"/login\">立即登录</a></p>\n                </div>\n\n            </div>\n        </div>\n        <div class=\"clear\"></div>\n    </div>\n</template>\n<script>\nimport axios from 'axios';\nexport default {\n    name: 'forgetPwd',\n    data() {\n        return {\n            show_1: true,\n            show_2: false,\n            show_3: false,\n            show_4: false,\n            imageUrl: '/static/images/VerifyCode.jpg',\n\n            fogetArgs: \"\",\n            imageVarifyCode: \"\",\n            userId: null,\n            phone: null,\n            userEmail: null,\n            userName: null,\n            password: null,\n            code: null,\n            text: \"\",\n            smsCode: null,\n            smsCodeInput: \"\",\n\n            isSuccess: false\n        }\n    },\n    methods: {\n        handleChange(isSuccess){\n            console.log(isSuccess)\n        },\n        onSuccess() {\n            console.log(\"验证成功\")\n            this.isSuccess = true\n        },\n        onFail() {\n            console.log(\"验证失败\")\n            this.isSuccess = false\n        },\n        onRefresh() {\n            console.log(\"验证码刷新\")\n        },\n        getSMSCode() {  //获取验证码\n            let that = this\n            axios({\n                method: 'post',\n                url: '/api/user/sendVerifyCode',\n                data: {\n                    userId: that.userId,\n                    phone: that.phone,\n                    userEmail: that.userEmail,\n                    userName: that.userName,\n                    password: that.password,\n                    code: that.code\n                }\n            })\n                .then(function (result) {\n                    console.log(result.data)\n                    that.smsCode = result.data\n                })\n        },\n        getUserInfo() {  //获取用户详细信息\n            let that = this\n            axios({\n                method: 'post',\n                url: '/api/user-info/getUserInfo',\n                data: {\n                    userId: that.userId,\n                    phone: that.phone,\n                    userEmail: that.userEmail,\n                    userName: that.userName,\n                    password: that.password,\n                    code: that.code\n                }\n            })\n                .then(function (result) {\n                    console.log(result)\n                    // console.log(result.data.object.phone)\n                    that.phone = result.data.object.phone\n                    console.log(result.data.object.userName)\n                    that.userName = result.data.object.userName\n                })\n        },\n        validateCode() {\n            let that = this\n            return new Promise((resolve, reject) => {\n                axios({\n                    method: 'post',\n                    url: '/api/user/validateCode',\n                    data: {\n                        userId: that.userId,\n                        phone: that.phone,\n                        userEmail: that.userEmail,\n                        userName: that.userName,\n                        password: that.password,\n                        code: that.smsCodeInput\n                    }\n                })\n                    .then(function (result) {\n                        console.log(\"验证码校验的返回值：\" + result.data.code)\n                        if (result.data.code == \"100001\") {\n                            resolve(true);\n                        } else {\n                            resolve(false);\n                        }\n                    })\n\n            })\n\n        },\n        show(stepIndex) {\n            switch (stepIndex) {\n                case 1:\n                    if (this.fogetArgs == \"\") {\n                        alert(\"请输入完整信息！\")\n                        return;\n                    }\n                    if (!this.isSuccess) {\n                        alert(\"请进行人机校验\")\n                        return\n                    }\n\n                    const phoneRegex = /^[1-9]\\d{10}$/;\n\n                    const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;\n\n                    const usernameRegex = /^user_\\d+$/;\n\n                    //发送请求获取图片验证码 todo\n                    // axios({\n                    //     method: 'get', \n                    //     url: '/api/user-info/getImageVerifyCode',\n                    // })\n                    // .then(function(result){\n\n                    // })\n\n                    if (phoneRegex.test(this.fogetArgs)) {\n                        this.phone = this.fogetArgs;\n                        this.text = \"激活码已经发送到您的手机：\" + this.phone + \" 中\"\n                    }\n                    if (emailRegex.test(this.fogetArgs)) {\n                        this.userEmail = this.fogetArgs;\n                        this.text = \"激活码已经发送到您的邮箱：\" + this.userEmail + \" 中\"\n                    }\n\n                    if (usernameRegex.test(this.fogetArgs)) {\n                        this.userName = this.fogetArgs;\n                        let that = this\n                        //获取用户详细信息\n                        this.getUserInfo()\n                        that.text = \"激活码已经发送到您的手机：\" + that.phone + \" 中\"\n                    }\n\n                    this.show_1 = false\n                    this.show_2 = true\n                    break\n                //cookie中存放用户编号和用户名\n                case 2:\n                    // let r = this.validateCode();\n                    // if (!r) {\n                    //     break\n                    // }\n                    let that = this\n                    this.validateCode().then(function (result) {\n                        if (result) {\n                            that.getUserInfo()\n                            that.show_2 = false\n                            that.show_3 = true\n                        } else {\n                            alert(\"验证码校验不通过\")\n                            return\n                        }\n                    })\n                    break\n                case 3:\n\n                    this.show_3 = false\n                    this.show_4 = true\n                    break\n                case 4:\n                    break\n            }\n        }\n    }\n}\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}